<!--
文件說明：詳細說明 settings.json 在圖形介面中顯示的各項設定欄位
分類：Configuration Reference (level: 2)
目標受眾：一般使用者
版本：1.7
最後更新：2026-02-03
-->

# settings.json 詳細設定說明

本文件詳細說明在圖形介面中看到的各項設定欄位。

---

## 📚 目錄

1. [設定方式](#設定方式)（含[搶票中即時修改設定](#搶票中即時修改設定--v202602-新增)）
2. [基礎設定](#基礎設定)
3. [日期選擇設定](#日期選擇設定)
4. [區域選擇設定](#區域選擇設定)
5. [驗證碼設定](#驗證碼設定)
6. [平台特定設定](#平台特定設定)
7. [進階設定](#進階設定)

---

## 設定方式

### 推薦方式：使用圖形介面

**網頁介面（推薦）**：
```bash
cd tickets_hunter/src
python settings.py
```
瀏覽器會自動開啟：`http://127.0.0.1:16888/`（預設 Port，可在進階設定中修改）

在圖形介面中，您可以直接透過中文欄位名稱進行設定，無需手動編輯 JSON 檔案。

> 💡 **Port 被佔用？** 若啟動失敗顯示「port is in used」，請參考[設定介面 Port](#設定介面-portserver_port-v202512-新增) 修改 Port 號碼。

### 搶票中即時修改設定 ⭐ v2026.02 新增

程式支援「即時套用」功能：**搶票中修改設定後儲存，程式會在 1 秒內自動套用新設定，不需要重新啟動。**

這在搶票過程中非常實用，例如：
- 發現關鍵字設錯 → 直接修改並儲存，程式立即使用新關鍵字
- 想改票數 → 直接修改張數，程式立即套用
- 需要除錯 → 打開「輸出除錯訊息」，立即看到詳細日誌

> ⚠️ **注意**：並非所有設定都支援即時套用。瀏覽器類型、帳號密碼、Cookie 等需要重新啟動才會生效。詳見 [Q2](#q2-修改設定後要重新啟動嗎)。

---

## 基礎設定

### 售票網站（homepage）
**必填** | 類型：字串

活動或票券的網址。


**支援平台**：
- TixCraft: `https://tixcraft.com/...`
- KKTIX: `https://kktix.com/events/...`
- TicketPlus: `https://ticketplus.com.tw/...`
- iBon: `https://ticket.ibon.com.tw/...`
- 其他支援平台

**提示**：直接複製活動頁面網址即可。

---

### 瀏覽器（browser）
選填 | 類型：字串 | 預設：chrome

指定使用的瀏覽器。


**可選值**：
- chrome - Google Chrome（**推薦**）
- firefox - Mozilla Firefox
- edge - Microsoft Edge
- safari - Safari（macOS）
- brave - Brave 瀏覽器


---

---

### 語言（language）
選填 | 類型：字串 | 預設：English

圖形介面語言設定。


**可選值**：
- 繁體中文
- English
- 日本語

---

### 門票張數（ticket_number）
**必填** | 類型：整數 | 預設：2

要購買的票數。


**注意**：
- 請遵守活動規定（通常限制 1-4 張）
- 超過限制可能導致購票失敗

---

### 刷新在指定時間（refresh_datetime）
選填 | 類型：字串 | 預設：空白

指定時間自動重整頁面開始搶票。


**格式**：HH:MM:SS（24小時制）

**範例值**：14:00:00

**使用情境**：
- 已知演唱會下午2點開賣
- 提前開啟程式並導航到售票頁面
- 程式會在 14:00:00 自動重整頁面並開始搶票

**停用**：留空即可

---

## 日期選擇設定

### 日期自動點選

**⭐ v1.2 新增功能**：條件式遞補控制（[日期自動遞補](#日期自動遞補-新功能)），可選擇當關鍵字失敗時是停止執行或自動遞補。

---

#### 啟用日期自動選擇
類型：布林值 | 預設：啟用

是否啟用日期自動選擇功能。

在圖形介面中顯示為：**日期自動點選** (啟用/停用開關)

**說明**：
- 開啟 - 自動選擇日期
- 關閉 - 等待手動選擇

---

#### 日期關鍵字
類型：字串 | 預設：空白

指定要選擇的日期的部分文字。

在圖形介面中顯示為：**日期關鍵字** (文字框)


**格式說明**：
- 多組關鍵字用分號分隔（OR 邏輯）
- 關鍵字內部用空格表示 AND 邏輯
- 逗號只是文字的一部分（例如價格 "3,280"）

**進階用法**：

| 需求 | 設定範例 | 說明 |
|------|---------|------|
| 單一日期 | 11/16 | 包含「11/16」的選項 |
| 多組日期（OR） | 11/16;11/17;11/18 | 三個日期任一命中即可 |
| 指定星期 | 週六;週日 | 週六或週日任一命中 |
| 指定時間 | 19:30;晚上 | 包含「19:30」或「晚上」 |
| 空格 AND | 11/16 上午 | 必須同時包含「11/16」和「上午」 |
| 組合 | 11/16 上午;11/16 下午 | 先找「11/16 上午」，找不到再找「11/16 下午」 |
| 不指定 | 留空 | 使用日期排序方式自動選 |

**詳細說明**：參考 [關鍵字與回退機制](keyword-mechanism.md#日期關鍵字機制)

---

#### 日期排序方式
類型：字串 | 預設：random

自動選擇日期的策略。

在圖形介面中顯示為：**日期排序方式** (下拉選單)

**使用時機**（v1.2 更新）：
1. **關鍵字未設定時**：直接使用此策略選擇
2. **關鍵字全失敗 + 日期自動遞補=開啟 時**：使用此策略自動遞補
3. **關鍵字全失敗 + 日期自動遞補=關閉 時**：停止執行（不使用此策略）

**可選值**：

| 值 | 中文說明 | 適用情境 |
|---|---------|---------|
| from top to bottom | 正序 | 選最早場次 |
| from bottom to top | 倒序 | 選最晚場次 |
| center | 取中間 | 平衡策略 |
| random | 隨機變化 | 增加變化性（預設） |

**詳細說明**：參考 [自動回退策略](keyword-mechanism.md#自動回退策略)

---

#### 日期自動遞補 ⭐ 新功能
類型：布林值 | 預設：**關閉**（嚴格模式）

當所有日期關鍵字都匹配失敗時的行為控制。

在圖形介面中顯示為：**日期自動遞補** (開關按鈕)

**可選值**：

| 開關狀態 | 中文說明 | 行為描述 |
|---------|---------|---------|
| **關閉** | **嚴格模式**（預設） | 關鍵字全失敗時**停止執行**，等待手動介入 |
| 開啟 | 自動遞補模式 | 關鍵字全失敗時**自動遞補**，使用「日期排序方式」選擇可用日期 |

**功能說明**：
- **嚴格模式（推薦）**：避免誤購不想要的場次
  - 關鍵字設定錯誤時會停止並等待修正
  - 適合對日期有嚴格要求的使用者
- **自動遞補模式**：確保程式持續運行
  - 即使關鍵字設定錯誤也會自動選擇
  - **風險**：可能購買到不想要的場次

**使用建議**：

| 使用情境 | 建議設定 | 原因 |
|---------|---------|------|
| 只想買特定日期（如：11/16） | 關閉 | 避免買到錯誤日期 |
| 任何日期都可以接受 | 開啟 | 確保能搶到票 |
| 混合策略 | 根據重要性決定 | 日期重要用「關閉」，不重要用「開啟」 |

**實戰範例**：
```
情境：只想買 11/16 的票

在圖形介面中設定：
- 日期關鍵字：11/16
- 日期自動遞補：關閉

結果：
✅ 若找到 11/16 → 選擇該日期
❌ 若找不到 11/16 → 停止執行，等待手動介入（不會自動選其他日期）
```

---

## 區域選擇設定

### 區域自動點選

**⭐ v1.2 新增功能**：條件式遞補控制（[區域自動遞補](#區域自動遞補-新功能)），可選擇當關鍵字失敗時是停止執行或自動遞補。

---

#### 啟用區域自動選擇
類型：布林值 | 預設：啟用

是否啟用區域自動選擇功能。

在圖形介面中顯示為：**區域自動點選** (啟用/停用開關)


---

#### 區域關鍵字
類型：字串 | 預設：空白

指定要選擇的區域的部分文字。

在圖形介面中顯示為：**區域關鍵字** (文字框)


**格式說明**：
- 多組關鍵字用分號分隔（OR 邏輯）
- 關鍵字內部用空格表示 AND 邏輯
- 逗號只是文字的一部分（例如價格 "3,280"）

**進階用法**：

| 需求 | 設定範例 | 說明 |
|------|---------|------|
| 單一區域 | 搖滾A | 包含「搖滾A」的選項 |
| 多組區域（OR） | 搖滾A;搖滾B;VIP | 三個區域任一命中即可 |
| 用票價選 | 3,280;2,680 | 包含「3,280」或「2,680」 |
| 用位置選 | 前排;中央 | 包含「前排」或「中央」 |
| 空格 AND | 搖滾A 前排 | 必須同時包含「搖滾A」和「前排」 |
| 組合 | 搖滾A 3,280;搖滾B 2,680 | 先找「搖滾A 3,280」，找不到再找「搖滾B 2,680」 |
| 不指定 | 留空 | 使用區域排序方式自動選 |

**詳細說明**：參考 [關鍵字與回退機制](keyword-mechanism.md#區域關鍵字機制)

---

#### 區域排序方式
類型：字串 | 預設：random

自動選擇區域的策略。

在圖形介面中顯示為：**區域排序方式** (下拉選單)

**使用時機**（v1.2 更新）：
1. **關鍵字未設定時**：直接使用此策略選擇
2. **關鍵字全失敗 + 區域自動遞補=開啟 時**：使用此策略自動遞補
3. **關鍵字全失敗 + 區域自動遞補=關閉 時**：停止執行（不使用此策略）

**可選值**：

| 值 | 中文說明 | 適用情境 |
|---|---------|---------|
| from top to bottom | 正序 | 選最貴/最好位置（通常） |
| from bottom to top | 倒序 | 選最便宜位置 |
| center | 取中間 | 中等價位 |
| random | 隨機變化 | 分散風險（預設） |

**詳細說明**：參考 [自動回退策略](keyword-mechanism.md#自動回退策略)

---

#### 區域自動遞補 ⭐ 新功能
類型：布林值 | 預設：**關閉**（嚴格模式）

當所有區域關鍵字都匹配失敗時的行為控制。

在圖形介面中顯示為：**區域自動遞補** (開關按鈕)

**可選值**：

| 開關狀態 | 中文說明 | 行為描述 |
|---------|---------|---------|
| **關閉** | **嚴格模式**（預設） | 關鍵字全失敗時**停止執行**，等待手動介入 |
| 開啟 | 自動遞補模式 | 關鍵字全失敗時**自動遞補**，使用「區域排序方式」選擇可用區域 |

**功能說明**：
- **嚴格模式（推薦）**：避免誤購不想要的座位/票種
  - 關鍵字設定錯誤時會停止並等待修正
  - 適合對座位有嚴格要求的使用者（如：只要搖滾區，不要看台）
- **自動遞補模式**：確保程式持續運行
  - 即使關鍵字設定錯誤也會自動選擇
  - **風險**：可能購買到不想要的座位（如：誤買輪椅席、視線不佳區）

**使用建議**：

| 使用情境 | 建議設定 | 原因 |
|---------|---------|------|
| 只想買特定區域（如：搖滾區） | 關閉 | 避免買到錯誤區域 |
| 任何座位都可以接受 | 開啟 | 確保能搶到票 |
| 混合策略 | 關閉 | 座位通常比日期更重要，建議保守 |

**實戰範例 1（嚴格模式）**：
```
情境：只想買搖滾區，其他區域不要

在圖形介面中設定：
- 區域關鍵字：搖滾區
- 區域自動遞補：關閉

結果：
✅ 若找到搖滾區 → 選擇搖滾區
❌ 若找不到搖滾區 → 停止執行，等待手動介入（不會自動選其他區域）
```

**實戰範例 2（混合模式）**：
```
情境：日期不重要，但座位很重要

在圖形介面中設定：
- 日期自動遞補：開啟（日期可以自動選）
- 區域自動遞補：關閉（座位必須嚴格匹配）

結果：日期會自動遞補，但座位必須符合關鍵字才會購買
```

---

### 排除關鍵字
**重要** | 類型：字串 | 預設：輪椅;身障;身心;障礙;Restricted View;燈柱遮蔽;視線不完整

設定**不要選擇**包含這些文字的區域。

在圖形介面中顯示為：**排除關鍵字** (文字框)

**說明**：
- 避免誤選輪椅席（通常需特殊資格）
- 避免選到視線受阻的區域

**使用提示**（在圖形介面中會看到）：
- 關鍵字用分號分隔（如：輪椅;不良）
- 關鍵字內有空格表示 AND 邏輯（如：VIP 包廂）
- 支援引號格式，但非必需

---

## 驗證碼設定

### 猜測驗證碼（ocr_captcha）

#### 啟用（enable）
類型：布林值 | 預設：**false**（停用）

是否啟用 OCR 自動辨識驗證碼。

**說明**：
- 停用 - 手動輸入驗證碼（預設，更安全）
- 啟用 - 自動 OCR 辨識（快速但有誤辨識風險）


**說明**：
- 啟用 - 自動 OCR 辨識驗證碼
- 停用 - 等待手動輸入

---

#### ddddocr beta（beta）
類型：布林值 | 預設：啟用

是否使用 beta OCR 模型。


**說明**：
- 啟用 - 使用 beta 模型
- 停用 - 使用標準模型

---

#### 掛機模式（force_submit）
類型：布林值 | 預設：啟用

辨識後是否自動送出表單。


**說明**：
- 啟用 - 辨識後自動送出（快速模式，完全掛機）
- 停用 - 辨識後等待手動確認（安全模式）

**建議**：
- 信任 OCR：啟用
- 希望確認：停用

---

#### OCR圖片取得方式（image_source）
類型：字串 | 預設：canvas

驗證碼圖片的來源類型。


**可選值**：
- canvas - 從 Canvas 元素擷取
- img - 從 img 標籤擷取

---

#### 自訂 OCR 模型 ⭐ v2025.11.25 新增
類型：字串 | 預設：空白

指定自訂 OCR 模型的目錄路徑，目前**僅支援 Ticketmaster 平台**。

在圖形介面中顯示為：**自訂 OCR 模型**（文字框）

**使用方式**：
1. 在 `assets/` 資料夾內建立模型目錄（例如：`assets/ocr_model/`）
2. 將以下兩個檔案放入該目錄：
   - `custom.onnx` - ONNX 格式的模型檔案
   - `charsets.json` - 字符集定義檔案
3. 在圖形介面填入路徑：`assets/ocr_model`

**錯誤處理**：
- 路徑未設定 → 使用預設 ddddocr 模型
- 檔案不存在 → 顯示警告，自動使用預設模型

**注意**：此功能目前僅支援 Ticketmaster 平台。

---

## 平台特定設定

### TixCraft（拓元售票）

#### 避開「搶購一空」的日期（pass_date_is_sold_out）
類型：布林值 | 預設：啟用

是否自動跳過已售完的日期。


**說明**：
- 啟用 - 自動過濾售完日期
- 停用 - 包含售完日期

---

#### 自動刷新倒數中的日期頁面（auto_reload_coming_soon_page）
類型：布林值 | 預設：啟用

遇到「即將開賣」頁面時是否自動重載。


**說明**：
- 啟用 - 自動重載等待開賣
- 停用 - 不重載

---

### KKTIX

#### KKTIX點選下一步按鈕（auto_press_next_step_button）
類型：布林值 | 預設：true勾選

是否自動點擊「下一步」按鈕。


---

#### 自動輸入張數（auto_fill_ticket_number）
類型：布林值 | 預設：啟用

是否自動填寫票數（KKTIX 價格清單式票種）。


---

#### KKTIX購票最長停留(秒)（max_dwell_time）
類型：整數 | 預設：90

在訂單頁面的最大停留時間（秒）。


**說明**：超過此時間會自動送出訂單（避免逾時）。

---

#### 會員序號或驗證問題自動填寫 ⭐ 新增功能
設定位置：進階設定 → **優惠代碼**

自動填寫 KKTIX 特定活動要求的會員序號或驗證問題答案。

在圖形介面中顯示為：**優惠代碼**（文字框）

**使用場景**：
- **會員專屬活動**：需要輸入會員序號才能購票
- **驗證問題活動**：需要輸入驗證答案（如：粉絲專屬問題）

**說明**：
- 程式會自動偵測 KKTIX 訂單頁面的序號輸入欄位
- 支援的欄位類型：
  - 會員序號欄位（`input.member-code`）
  - AngularJS 綁定欄位（`input[ng-model*="member_codes"]`）
  - 任何包含「序號」、「驗證」關鍵字的欄位
- 自動觸發 AngularJS 事件確保表單驗證通過

**範例**：
```
MEMBER12345
FANCLUB2024
```

**注意**：
- 僅在特定活動頁面出現序號欄位時才需要設定
- 如果活動無需序號，請保持空白
- 序號格式依各活動主辦方規定

**詳細說明**：參閱「進階設定 → 優惠代碼設定（通用）」章節

---

### iBon（ibon 售票系統）

#### 驗證問題自動填寫 ⭐ v2025.12 新增

**功能說明**：iBon 購票時有時會出現驗證問題頁面，要求輸入手機號碼末幾碼、信用卡前 6 碼等資訊。此功能可自動偵測並填寫這些驗證問題。

**設定位置**：進階設定 → **使用者自定字典**

**使用方式**：

在「使用者自定字典」欄位輸入可能用到的資料，程式會自動根據問題類型提取正確答案。

**智慧提取功能**：

| 問題類型 | 您輸入的資料 | 程式自動填入 |
|---------|------------|-------------|
| 請輸入手機末三碼 | `0912345678`（完整手機號碼） | `678`（自動取末 3 碼） |
| 請輸入手機後四碼 | `0912345678` | `5678`（自動取末 4 碼） |
| 請輸入信用卡前6碼 | `123456`（只需輸入前 6 碼） | `123456` |
| 請輸入訂單號碼前4碼 | `D12345678`（完整訂單號碼） | `D123`（自動取前 4 碼） |
| 請輸入訂單號碼 | `D12345678` | `D12345678`（完整輸入） |

**多種資料設定**：

如果活動可能問到多種資料，請用分號 `;` 分隔：

```
0912345678;123456;D12345678
```

程式會自動判斷問題類型並選擇正確的資料。

**雙欄位表單**：

若驗證頁面有兩個輸入欄位，資料會按順序填入：

| 輸入設定 | 結果 |
|---------|------|
| `123456;A123456789` | 第一欄=`123456`，第二欄=`A123456789` |

**安全建議**：
- 信用卡資料只需輸入前 6 碼即可（更安全）

---

### Cityline（Cityline 買飛）

#### ⚠️ 半自動登入模式

**重要說明**：Cityline 採用**半自動登入策略**，需要使用者配合手動操作。

**登入流程**：

1. **自動填入帳號**
   - 程式會自動填入您在設定中輸入的 Email 帳號
   - 顯示訊息：`[CITYLINE LOGIN] Email entered: vic***`
   - 提示：`[CITYLINE LOGIN] Please manually enter password and click login button`

2. **手動輸入密碼**
   - 在瀏覽器視窗中輸入您的密碼

3. **到信箱收取驗證碼**
   - Cityline 會發送驗證碼到您的註冊信箱
   - 開啟信箱，找到驗證碼
   - 在登入頁面輸入驗證碼

4. **完成 Cloudflare Turnstile 驗證**
   - 登入頁面會顯示 Cloudflare Turnstile 驗證（類似 reCAPTCHA）
   - 程式會自動等待驗證完成（登入按鈕從 `opacity: 0.3` 變為 `opacity: 1`）

5. **手動點擊登入按鈕**
   - 所有驗證完成後，**手動點擊「登入」按鈕**
   - 程式會自動偵測登入完成（URL 變化或 DOM 元素出現）
   - 顯示：`[CITYLINE LOGIN] Login completed after Xs`

6. **自動繼續搶票**
   - 登入成功後，程式會：
     - 自動重定向到目標活動頁面（`[CITYLINE LOGIN] Redirecting to target page...`）
     - 繼續執行搶票流程（日期選擇 → 區域選擇 → 購票）

**時間限制**：
- ⏱️ 程式會等待最長 **5 分鐘**（300 秒）供您完成手動登入
- 每 10 秒顯示一次等待提示：`[CITYLINE LOGIN] Still waiting... (Xs elapsed)`

**為什麼不能全自動登入？**
- Cityline 使用 **Email 驗證碼**（需要收信）
- Cloudflare Turnstile 驗證需要真實使用者互動
- 使用 **HttpOnly Session Cookie**，無法透過程式碼存取
- 半自動模式在安全性與自動化之間取得平衡

**設定位置**：
- 在圖形介面中找到「進階設定」→「帳號密碼設定」→「cityline」
- 只需填寫**帳號（Email）**，密碼欄位可留空

---

### HKTicketing（香港快達票）

#### ⚠️ 半自動登入模式

**重要說明**：HKTicketing 採用**半自動登入策略**，需要使用者配合手動操作。

**支援網站**：
- `hkt.hkticketing.com`（Type02 SPA 版本）✅ 完全支援
- `premier.hkticketing.com`（Type01 傳統版本）建議使用 Chrome 版本

**登入流程**（Type02）：

1. **自動填入帳號密碼**
   - 程式會自動填入您在設定中輸入的 Email 帳號和密碼
   - 顯示訊息：`[HKTICKETING TYPE02] Account filled`
   - 顯示訊息：`[HKTICKETING TYPE02] Password filled`

2. **自動點擊登入按鈕**
   - 程式會自動點擊登入按鈕
   - 顯示訊息：`[HKTICKETING TYPE02] Login button clicked`

3. **手動完成驗證碼**
   - 如果出現驗證碼（圖形驗證或滑動驗證）
   - 請在瀏覽器視窗中手動完成驗證
   - 顯示提示：`[HKTICKETING TYPE02] Please complete captcha verification if prompted...`

4. **自動偵測登入完成**
   - 程式會自動偵測 URL 變化確認登入成功
   - 顯示：`[HKTICKETING TYPE02] Login successful (URL changed)`

5. **自動繼續搶票**
   - 登入成功後，程式會：
     - 自動重定向到目標活動頁面
     - 繼續執行搶票流程（日期選擇 → 區域選擇 → 購票）

**時間限制**：
- ⏱️ 程式會等待最長 **3 分鐘**（180 秒）供您完成驗證碼

**為什麼不能全自動登入？**
- HKTicketing 使用**圖形驗證碼**或**滑動驗證**
- 這些驗證機制需要真實使用者互動
- 半自動模式在安全性與自動化之間取得平衡

**設定位置**：
- 在圖形介面中找到「進階設定」→「帳號密碼設定」→「hkticketing」
- 填寫**帳號（Email）**和**密碼**

---

## 進階設定

**在圖形介面中，這些設定位於「進階設定」頁籤**

### 設定介面 Port（server_port）⭐ v2025.12 新增
類型：整數 | 預設：16888

設定介面 Web Server 的連接埠號碼。

在圖形介面中顯示為：**設定介面 Port**（數字輸入框）

**說明**：
- 預設 Port 為 16888
- 若遇到 Port 被系統阻擋或佔用，可修改為其他可用 Port
- 建議範圍：16000-17000
- **修改後需重新啟動設定介面才會生效**

**使用情境**：
- Windows 系統可能會保留某些 Port（受 Hyper-V、WSL、Docker 等影響）
- 若啟動 `settings.py` 時出現「port is in used」錯誤，可嘗試更換 Port

**檢查 Port 是否被佔用**（Windows CMD）：
```cmd
netsh interface ipv4 show excludedportrange protocol=tcp
```

**範例**：
- 16888（預設）
- 16889
- 17000

---

### 輸出詳細除錯訊息（verbose）
類型：布林值 | 預設：停用

是否顯示詳細的執行過程訊息。


**說明**：
- 啟用 - 顯示詳細日誌
- 停用 - 僅顯示關鍵訊息


**警告**：輸出大量日誌可能影響搶票效能，除非需要除錯，否則建議保持關閉。

---

### 無圖形界面模式（headless）
類型：布林值 | 預設：停用

是否使用無頭模式（不顯示瀏覽器視窗）。


**說明**：
- 啟用 - 背景執行，不顯示瀏覽器
- 停用 - 顯示瀏覽器視窗

**建議**：保持停用，方便觀察執行過程

---

### 瀏覽器視窗大小（window_size）
類型：字串 | 預設：600,1024

瀏覽器視窗大小。


**格式**：寬度,高度

---

### 自動刷新頁面間隔(秒)（auto_reload_page_interval）
類型：浮點數 | 預設：5.0

自動重載頁面的間隔時間（秒）。


**說明**：較小的值會更頻繁重載，但可能觸發過熱保護。

---

### 音效通知

#### 有票時播放音效（play_sound.ticket）
類型：布林值 | 預設：啟用

選到票時是否播放音效。


---

#### 訂購時播放音效（play_sound.order）
類型：布林值 | 預設：啟用

送出訂單時是否播放音效。


---

#### 音效檔（play_sound.filename）
類型：字串 | 預設：assets/sounds/ding-dong.wav

音效檔案路徑。


---

### Discord Webhook 通知 ⭐ v2025.12 新增

#### Discord Webhook URL（discord_webhook_url）
類型：字串 | 預設：空白

設定 Discord Webhook 網址，當找到票券或訂單成功時自動發送通知到您的 Discord 頻道。

在圖形介面中顯示為：**Discord Webhook URL**（文字框）

**功能說明**：
- **找到票券時**：發送「[平台名稱] found ticket! Please check your computer」
- **訂單成功時**：發送「[平台名稱] order success! Please checkout and pay ASAP」
- 通知不會影響搶票流程（使用非同步發送，3 秒超時）

**如何建立 Discord Webhook**：

1. **建立或選擇 Discord 伺服器**
   - 開啟 Discord 應用程式或網頁版
   - 如果沒有自己的伺服器，點擊左側「+」建立新伺服器

2. **進入伺服器設定**
   - 點擊伺服器名稱旁的下拉箭頭 ▼
   - 選擇「伺服器設定」(Server Settings)

3. **建立 Webhook**
   - 在左側選單找到「整合」(Integrations)
   - 點擊「檢視 Webhooks」或「Webhooks」
   - 點擊「新建 Webhook」(New Webhook)

4. **設定 Webhook**
   - 命名您的 Webhook（例如：Tickets Hunter）
   - 選擇要接收通知的頻道
   - 可選：上傳自訂頭像

5. **複製 Webhook URL**
   - 點擊「複製 Webhook URL」按鈕
   - URL 格式類似：`https://discord.com/api/webhooks/1234567890/abcdefg...`

6. **貼上到設定介面**
   - 回到 Tickets Hunter 設定介面
   - 在「進階設定」頁籤找到「Discord Webhook URL」
   - 貼上剛才複製的 URL
   - 儲存設定

**注意事項**：
- Webhook URL 是敏感資訊，請勿分享給他人
- 留空則停用 Discord 通知功能
- 通知失敗不會影響搶票流程

**官方參考文件**：[Discord Webhooks 介紹](https://support.discord.com/hc/en-us/articles/228383668-Intro-to-Webhooks)

---

### Cookie 設定（快速登入）

#### 拓元家族 cookie（tixcraft_sid）
類型：字串 | 預設：空白

拓元家族網站的登入 Cookie，用於快速登入。

**各平台 Cookie 名稱**：
| 平台 | Cookie 名稱 |
|------|------------|
| TixCraft 拓元 | `TIXUISID` |
| iNDIEVOX | `IVUISID` |
| Ticketmaster SG | `TIXPUISID` |

**取得方式**：
1. 在對應網站登入
2. 開啟瀏覽器開發者工具（F12）
3. Application → Cookies → 找到上表對應的 Cookie 名稱
4. 複製值並填入

---

#### ibon cookie ibonqware（ibonqware）
類型：字串 | 預設：空白

iBon 的 Cookie qware，用於快速登入。


**取得方式**：
1. 在 iBon 網站登入
2. 開啟瀏覽器開發者工具（F12）
3. Application → Cookies → 找到 `qware`
4. 複製值並填入

---

### 帳號密碼設定

支援多個平台的帳號密碼設定：

| 平台 | 帳號欄位 | 密碼欄位 | 圖形介面顯示 |
|------|---------|---------|-------------|
| KKTIX | kktix_account | kktix_password | KKTIX 帳號 / KKTIX 密碼 |
| TicketPlus | ticketplus_account | ticketplus_password | 遠大 帳號 / 遠大 密碼 |
| KHAM | kham_account | kham_password | 寬宏 帳號 / 寬宏 密碼 |
| Cityline | cityline_account | cityline_password | cityline 帳號 / cityline 密碼 |
| 年代 | ticket_account | ticket_password | 年代 帳號 / 年代 密碼 |
| HKTicketing | hkticketing_account | hkticketing_password | HKTICKETING 帳號 / HKTICKETING 密碼 |
| FamiTicket | fami_account | fami_password | FamiTicket 帳號 / FamiTicket 密碼 |
| Facebook | facebook_account | facebook_password | Facebook 帳號 / Facebook 密碼 |
| UDN | udn_account | udn_password | UDN 帳號 / UDN 密碼 |

**注意**：
- 明文密碼有安全風險，建議使用 Cookie 登入
- 密碼會以明文儲存在 settings.json
- 圖形介面會顯示警告：`將密碼保存到設定檔中可能會讓您的密碼被盜。`

**⚠️ UDN 登入是半自動的**：
- 程式會自動填寫帳號密碼
- **您需要手動完成 reCAPTCHA 圖片驗證**（選擇公車、腳踏車、紅綠燈等圖片）
- **您需要手動點擊「登入」按鈕**
- 程式會自動偵測登入成功並繼續搶票流程
- 這是平台安全措施，非程式限制

---

### 優惠代碼設定（通用）⭐ 新增功能

#### 優惠代碼（discount_code）
類型：字串 | 預設：空白

適用於所有平台的優惠代碼，程式會自動偵測並填入對應欄位。

在圖形介面中顯示為：**優惠代碼**（文字框，位於進階設定頁籤）

**支援平台與功能**：

| 平台 | 功能類型 | 欄位名稱範例 | 使用場景 |
|------|---------|------------|---------|
| **KKTIX** | 會員序號 | member_code | 會員專屬活動需要輸入序號驗證資格 |
| **TicketPlus** | 優惠序號 | exclusive_code | 特定活動要求優惠序號才能購票 |

**說明**：
- **單一設定支援多平台**：無需為每個平台設定不同欄位
- **自動偵測欄位類型**：程式會根據頁面內容自動判斷欄位用途
- **智慧填寫**：根據平台特性選擇對應的 DOM 操作方式
  - KKTIX：觸發 AngularJS 事件（`input` + `change` + `blur` + `scope.$apply()`）
  - TicketPlus：觸發 Vue.js 事件（`input` + `change`）

**範例**：
```
DISCOUNT2024
MEMBER12345
FANCLUB999
```

**常見使用情境**：
1. **粉絲專屬活動**：需要輸入粉絲序號
2. **早鳥優惠**：需要輸入早鳥代碼
3. **信用卡優惠**：需要輸入銀行代碼
4. **會員專屬**：需要輸入會員編號

**注意**：
- 僅在特定活動頁面出現代碼欄位時才需要設定
- 如果活動無需代碼，請保持空白
- 代碼格式依各活動主辦方規定

**設定位置**：
1. 在圖形介面中找到「進階設定」頁籤
2. 向下滾動到「其他設定」區塊
3. 找到「優惠代碼」欄位並填入

---

## 💡 設定建議

### 建議 1：新手推薦設定
- **日期排序方式**：正序（選最早場次）
- **區域排序方式**：正序（選最好位置）
- **排除關鍵字**：務必設定（避免誤選輪椅席）
- **輸出詳細除錯訊息**：關閉（避免影響效能，除非需要除錯）

---

### 建議 2：進階使用者
- 使用多組關鍵字提高成功率
- 善用 AND 邏輯精確匹配（分號分隔）
- 啟用音效通知（有票時/訂購時）

---

### 建議 3：測試設定
正式開搶前，用其他活動測試設定：
1. 填寫一個可用的活動網址
2. 設定關鍵字與參數
3. 啟動程式觀察執行過程
4. 根據詳細輸出調整設定

---

## ❓ 常見問題

### Q1: 圖形介面和 settings.json 哪個優先？  
**A:** 圖形介面修改後會自動儲存到 settings.json。
---

### Q2: 修改設定後要重新啟動嗎？
**A:** 大部分設定**不需要重新啟動**！程式支援「即時套用」功能，搶票中修改設定後儲存，程式會自動偵測並套用。

**可以即時套用的設定**（不需重啟）：
- 張數、日期/區域關鍵字、排除關鍵字
- 日期/區域自動遞補、排序方式
- 刷新間隔、刷新在指定時間
- 輸出除錯訊息、音效通知
- OCR 驗證碼設定
- 優惠代碼、使用者自定字典
- Discord Webhook URL
- 聯絡人資訊
- KKTIX、拓元平台專用設定

**需要重新啟動的設定**：
- 售票網站網址
- 瀏覽器
- 無圖形界面模式、視窗大小
- 設定介面 Port、Proxy
- 所有帳號密碼和 Cookie

---

### Q3: 可以同時用多個設定檔嗎？
**A:** 可以！使用 config_launcher.py 管理多個設定檔：
- 在 tickets_hunter/src 目錄執行 python config_launcher.py

---

### Q4: 可以備份設定檔嗎？
**A:** 可以！複製 settings.json 並改名即可備份。

---

### Q5: 系統支援哪些語言？

**A:** 系統針對不同功能提供多語言支援：

#### 完整多語言支援（繁體中文、英文、日文）
- 「尚未開賣」偵測：支援「尚未開賣」、「Not Started」、「まだ発売」
- 「即將開賣」偵測：支援「即將開賣」、「Coming Soon」
- 「售完」偵測：支援「已售完」、「Sold Out」

#### 範例
- 關鍵字設定「週六 19:30」（繁體中文）

---

## 📚 延伸閱讀

- [快速入門指南](quick-start.md) - 第一次使用設定
- [關鍵字與回退機制](keyword-mechanism.md) - 深入了解關鍵字邏輯
- [使用者手冊首頁](README.md) - 回到總覽

---

## 💬 需要協助？

遇到問題或有疑問？歡迎到社群尋求協助：

- 🙋 **[Q&A 問題解答](https://github.com/bouob/tickets_hunter/discussions/categories/q-a)** - 使用疑問先來這裡問
- 💬 **[一般討論](https://github.com/bouob/tickets_hunter/discussions/categories/general)** - 分享使用經驗
- 🐛 **[回報 Bug](https://github.com/bouob/tickets_hunter/issues/new?template=bug_report.md)** - 確定是程式錯誤請開 Issue
- 💡 **[功能建議](https://github.com/bouob/tickets_hunter/discussions/categories/ideas)** - 想要新功能到這裡提案

---

**祝您搶票成功！** 🎉

*最後更新：2026-02-03 | 版本：1.7*
